# Trae 项目规则文档

## 项目概述
本项目是一个基于EJS模板引擎的物理演示网站框架，用于构建和展示物理现象的交互式演示。

## 项目结构规则

### 目录结构
```
项目根目录/
├── data/                 # 数据文件目录
│   └── navigation.json   # 导航配置数据
├── demos/                # 演示模块目录
│   ├── demo-name/        # 单个演示模块
│   │   ├── demo.json     # 演示配置
│   │   ├── demo.ejs      # 演示模板
│   │   ├── demo.css      # 演示样式
│   │   └── demo.js       # 演示脚本
├── templates/            # 模板文件目录
│   ├── layout.ejs        # 主布局模板
│   ├── navigation.ejs    # 导航模板
│   ├── breadcrumb.ejs    # 面包屑模板
│   └── footer.ejs        # 页脚模板
├── public/               # 构建输出目录
├── dist/                # 压缩后输出目录
└── build.js             # 构建脚本
```

### 文件命名规则
- **演示模块目录**: 使用kebab-case命名（如：`friction-inclined-plane`）
- **配置文件**: 统一使用`demo.json`命名
- **模板文件**: 使用`.ejs`扩展名
- **样式文件**: 使用`.css`扩展名
- **脚本文件**: 使用`.js`扩展名

## 开发规范

### 1. 模板开发规则
- 所有页面模板必须继承自`layout.ejs`
- 使用EJS模板语法，保持代码简洁
- 模板变量通过`data`对象传递
- 包含必要的模板片段（navigation, breadcrumb, footer）

### 2. 演示模块规则
每个演示模块必须包含以下文件：
- `demo.json`: 演示元数据和配置
- `demo.ejs`: 演示内容模板
- `demo.css`: 演示专用样式
- `demo.js`: 演示交互逻辑

### 3. 样式开发规则
- 使用CSS3标准语法
- 优先使用Flexbox/Grid布局
- 响应式设计，支持移动端
- 避免使用!important

### 4. JavaScript开发规则
- 使用ES6+语法
- 模块化组织代码
- 避免全局变量污染
- 添加适当的错误处理

## 构建和部署规则

### 构建流程
1. 运行 `npm run build` 生成静态文件到`public/`目录
2. 自动压缩HTML、CSS、JS文件到`dist/`目录
3. 检查构建输出是否有错误

### 开发服务器
- 运行 `npm run dev` 启动本地开发服务器
- 默认端口：8080
- 自动打开浏览器

## 代码质量规则

### 1. 代码格式
- 使用2个空格缩进
- 文件末尾保留空行
- 适当的注释和文档

### 2. 性能优化
- 图片资源压缩
- CSS和JS文件压缩
- 减少HTTP请求

### 3. 浏览器兼容性
- 支持现代浏览器（Chrome, Firefox, Safari, Edge）
- 渐进增强原则

## 版本控制规则

### Git工作流
- 主分支：main
- 功能分支：feature/feature-name
- 修复分支：fix/bug-name

### 提交信息规范
- 格式：`类型: 描述`
- 类型：feat, fix, docs, style, refactor, test, chore
- 示例：`feat: 添加凸透镜演示模块`

## 测试规则

### 测试覆盖
- 单元测试：演示逻辑测试
- 集成测试：页面渲染测试
- 端到端测试：用户交互测试

## 文档规则

### 项目文档
- README.md: 项目说明和使用指南
- API文档：接口说明
- 演示文档：每个演示的使用说明

### 代码文档
- 函数注释：使用JSDoc格式
- 复杂逻辑：添加详细注释
- 配置说明：配置文件注释

## 安全规则

### 代码安全
- 避免XSS攻击：对用户输入进行转义
- 文件上传安全：限制文件类型和大小
- HTTPS部署：生产环境使用HTTPS

### 依赖安全
- 定期更新依赖包
- 使用安全版本
- 扫描安全漏洞

## 维护规则

### 定期维护
- 每月检查依赖更新
- 季度性能优化
- 年度架构审查

### 问题处理
- 建立问题跟踪系统
- 优先级分类处理
- 定期回顾和改进

---

*最后更新: 2024年*  
*维护者: 项目团队*